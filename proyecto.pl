% prolog
estudiante(2000100001,1,[math101, phys201, ec201]) .
estudiante(2000100002,1,[math101, phys201, hist301]).
estudiante(2000100003,1,[math101, ec201, hist301]) .
estudiante(2000100004,1,[math101, phys201, ec201, hist301]).
estudiante(2000100007,0,[ec201, phys201]).
estudiante(2000100015,0,[ec201, hist301]) .
estudiante(2000100016,0,[cmpe150, hist301]).
estudiante(2000100017,0,[]).
estudiante(2000100008,0,[math101, phys201]) .
estudiante(2000100009,1,[phys201, ec201]).
estudiante(2000100010,0,[cmpe150, math101]).
estudiante(2000100011,0,[cmpe150, hist301]).
estudiante(2000100012,1,[math101, phys201]).
estudiante(2002100009,0,[math101, ec201, hist301]).
estudiante(2002100071,0,[phys201, ec201, hist301]).
estudiante(2002100053,0,[cmpe150, ec201]).
estudiante(2002100040,1,[math101, hist301]).
estudiante(2002100032,0,[phys201, ec201]).
estudiante(2002100010,0,[cmpe150]).
estudiante(2002103010,1,[]).
estudiante(2000100101,1,[math101, phys201, ec201]) .
estudiante(2000100202,1,[math101, phys201, hist301]).
estudiante(2000100303,1,[math101, ec201, hist301]) .
estudiante(2000100404,1,[math101, phys201, ec201, hist301]).
estudiante(2000100507,0,[ec201, phys201]).
estudiante(2000100615,0,[ec201, hist301]) .
estudiante(2000100716,0,[cmpe150, hist301]).
estudiante(2000100817,0,[]).
estudiante(2000100908,0,[math101, phys201]) .
estudiante(2000100109,1,[phys201, ec201]).
estudiante(2000100210,0,[cmpe150, math101]).
estudiante(2000100311,0,[cmpe150, hist301]).
estudiante(2000100412,1,[math101, phys201]).
estudiante(2002100509,0,[math101, ec201, hist301]).
estudiante(2002100671,0,[phys201, ec201, hist301]).
estudiante(2002100753,0,[cmpe150, ec201]).
estudiante(2002100840,1,[math101, hist301]).
estudiante(2002100932,0,[phys201, ec201]).
estudiante(2002101010,0,[cmpe150]).
estudiante(2002103510,1,[]).
estudiante(2000109101,1,[math101, phys201, ec201]) .
estudiante(2000108202,1,[math101, phys201, hist301]).
estudiante(2000107303,1,[math101, ec201, hist301]) .
estudiante(2000106404,1,[math101, phys201, ec201, hist301]).
estudiante(2000105507,0,[ec201, phys201]).
estudiante(2000104615,0,[ec201, hist301]) .
estudiante(2000103716,0,[cmpe150, hist301]).
estudiante(2000102817,0,[]).
estudiante(2000101908,0,[math101, phys201]) .
estudiante(2000102109,1,[phys201, ec201]).
estudiante(2000103210,0,[cmpe150, math101]).
estudiante(2000104311,0,[cmpe150, hist301]).
estudiante(2000105412,1,[math101, phys201]).
estudiante(2002106509,0,[math101, ec201, hist301]).
estudiante(2002107671,0,[phys201, ec201, hist301]).
estudiante(2002108753,0,[cmpe150, ec201]).
estudiante(2002109840,1,[math101, hist301]).
estudiante(2002109932,0,[phys201, ec201]).
estudiante(2002108010,0,[cmpe150]).
estudiante(2002173510,1,[]).
estudiante(2000101958,0,[math101, phys201]) .
estudiante(2000102139,1,[phys201, ec201]).
estudiante(2000103215,0,[cmpe150, math101]).
estudiante(2000104311,0,[cmpe150, hist301]).
estudiante(2000105412,1,[math101, phys201]).
estudiante(2002196509,0,[math101, hist301]).
aula(nh101, 50, 10).
aula(nh201, 50, 5).
aula(nh301, 50, 15).
aula(m2001, 30, 5).
aula(etaa2, 30, 5).
aula(etaa3, 35, 5).
aula(etaa4, 30, 10).
aula(etaa5, 20, 5).
aula(etaa6, 30, 5).
aula(etaa7, 25, 10).
aula(etaa8, 30, 15).
aula(etaa9, 35, 5).
aula(etb101, 20, 5).
aula(etb201, 45, 5).
aula(etb301, 56, 5).
aula(etb401, 67, 5).
aula(etb501, 28, 5).
aula(etb601, 23, 10).
aula(etb701, 44, 5).
aula(etb801, 55, 5).
aula(etb901, 26, 10).
aula(ppd101, 20, 5).
aula(ppd201, 30, 5).
aula(ppd301, 40, 15).
aula(ppd401, 50, 15).
aula(ppd501, 60, 5).
aula(ppd601, 70, 15).
aula(ppd701, 80, 15).
aula(ppd801, 35, 5).
aula(ppd901, 25, 10).
aula(wwe101, 21, 5).
aula(wwe201, 31, 5).
aula(wwe301, 21, 15).
aula(wwe401, 41, 5).
aula(wwe501, 51, 5).
aula(wwe601, 21, 15).
aula(wwe701, 51, 5).
aula(wwe801, 21, 5).
aula(wwe901, 21, 5).
aula(hkd101, 30, 10).
aula(hkd201, 40, 20).
aula(hkd301, 50, 5).
aula(hkd401, 25, 5).
aula(hkd501, 25, 10).
aula(hkd601, 15, 20).
aula(hkd701, 30, 10).
aula(hkd801, 45, 15).
aula(hkd901, 50, 10).
aula(ppmd101, 20, 5).
aula(ppmd201, 30, 5).
aula(ppmd301, 20, 5).
aula(ppmd401, 20, 5).
aula(ppmd501, 20, 5).
aula(ppmd601, 30, 5).
aula(ppmd701, 40, 10).
aula(ppmd801, 50, 15).
aula(ppmd901, 35, 5).
aula(dtf101, 25, 5).
aula(dtf102, 25, 5).
aula(dtf201, 35, 5).
aula(dtf301, 45, 15).
aula(dtf401, 20, 5).
aula(dtf501, 20, 5).
aula(dtf601, 30, 5).
aula(dtf701, 40, 10).
aula(dtf801, 50, 15).
aula(dtf901, 20, 5).
fechaexam(cmpe150, ['16.05.2018', '26.06.2018', '04.07.2018']).
fechaexam(cmpe150, ['17.06.2018', '26.07.2018', '04.08.2018']).
fechaexam(cmpe150, ['01.07.2018', '26.08.2018', '24.09.2018']).
fechaexam(cmpe150, ['11.08.2018', '06.09.2018', '04.10.2018']).
fechaexam(cmpe150, ['21.09.2018', '26.10.2018', '14.11.2018']).
fechaexam(cmpe150, ['15.04.2017', '25.05.2017', '04.06.2017']).
fechaexam(cmpe150, ['15.04.2018', '25.05.2018', '04.06.2018']).
fechaexam(cmpe150, ['15.01.2017', '25.02.2017', '04.03.2017']).
fechaexam(cmpe150, ['15.10.2017', '25.11.2017', '04.12.2017']).
fechaexam(cmpe150, ['15.07.2017', '25.08.2017', '04.09.2017']).
fechaexam(cmpe150, ['10.04.2017', '20.05.2017', '14.06.2017']).
fechaexam(cmpe150, ['25.04.2017', '12.05.2017', '13.06.2017']).
fechaexam(math101, ['17.04.2017', '15.05.2017', '04.06.2017']).
fechaexam(math101, ['02.07.2018', '16.08.2018', '23.09.2018']).
fechaexam(math101, ['22.08.2018', '06.09.2018', '03.10.2018']).
fechaexam(math101, ['19.06.2018', '16.07.2018', '02.08.2018']).
fechaexam(math101, ['27.04.2017', '15.05.2017', '05.06.2017']).
fechaexam(math101, ['22.09.2018', '16.10.2018', '13.11.2018']).
fechaexam(math101, ['17.04.2018', '15.05.2018', '04.06.2018']).
fechaexam(math101, ['18.05.2018', '16.06.2018', '14.07.2018']).
fechaexam(math101, ['07.01.2017', '15.02.2017', '06.03.2017']).
fechaexam(math101, ['27.04.2017', '15.05.2017', '07.06.2017']).
fechaexam(math101, ['07.07.2017', '15.08.2017', '08.09.2017']).
fechaexam(math101, ['27.10.2017', '15.11.2017', '09.12.2017']).
fechaexam(math101, ['07.05.2017', '15.05.2017', '10.06.2017']).
fechaexam(phys201, ['10.04.2017', '20.05.2017', '14.06.2017']).
fechaexam(phys201, ['16.06.2018', '20.07.2018', '06.08.2018']).
fechaexam(phys201, ['16.05.2018', '20.06.2018', '06.07.2018']).
fechaexam(phys201, ['03.07.2018', '20.08.2018', '16.09.2018']).
fechaexam(phys201, ['13.08.2018', '00.09.2018', '06.10.2018']).
fechaexam(phys201, ['23.09.2018', '20.10.2018', '16.11.2018']).
fechaexam(phys201, ['13.10.2018', '30.11.2018', '26.12.2018']).
fechaexam(phys201, ['15.04.2018', '19.05.2018', '05.06.2018']).
fechaexam(phys201, ['11.04.2017', '21.05.2017', '15.06.2017']).
fechaexam(phys201, ['12.04.2017', '22.05.2017', '16.06.2017']).
fechaexam(phys201, ['13.04.2017', '23.05.2017', '17.06.2017']).
fechaexam(phys201, ['14.04.2017', '24.05.2017', '18.06.2017']).
fechaexam(phys201, ['15.04.2017', '25.05.2017', '19.06.2017']).
fechaexam(phys201, ['16.04.2017', '26.05.2017', '20.06.2017']).
fechaexam(ec201, ['16.04.2017', '20.05.2017', '01.06.2017']).
fechaexam(ec201, ['16.04.2018', '20.05.2018', '02.06.2018']).
fechaexam(ec201, ['17.05.2018', '21.06.2018', '07.07.2018']).
fechaexam(ec201, ['15.06.2018', '21.07.2018', '05.08.2018']).
fechaexam(ec201, ['04.07.2018', '21.08.2018', '17.09.2018']).
fechaexam(ec201, ['14.08.2018', '01.09.2018', '07.10.2018']).
fechaexam(ec201, ['24.09.2018', '21.10.2018', '17.11.2018']).
fechaexam(ec201, ['14.10.2018', '31.11.2018', '27.12.2018']).
fechaexam(ec201, ['17.04.2017', '21.05.2017', '02.06.2017']).
fechaexam(ec201, ['18.04.2017', '22.05.2017', '03.06.2017']).
fechaexam(ec201, ['19.04.2017', '23.05.2017', '04.06.2017']).
fechaexam(ec201, ['20.04.2017', '24.05.2017', '05.06.2017']).
fechaexam(ec201, ['21.04.2017', '25.05.2017', '06.06.2017']).
fechaexam(ec201, ['22.04.2017', '26.05.2017', '07.06.2017']).
fechaexam(hist301, ['14.04.2017', '21.05.2017', '01.06.2017']).
fechaexam(hist301, ['15.05.2018', '22.06.2018', '12.07.2018']).
fechaexam(hist301, ['05.07.2018', '22.08.2018', '22.09.2018']).
fechaexam(hist301, ['14.06.2018', '22.07.2018', '03.08.2018']).
fechaexam(hist301, ['14.04.2018', '21.05.2018', '01.06.2018']).
fechaexam(hist301, ['25.08.2018', '02.09.2018', '02.10.2018']).
fechaexam(hist301, ['25.09.2018', '22.10.2018', '12.11.2018']).
fechaexam(hist301, ['15.10.2018', '29.11.2018', '22.12.2018']).
fechaexam(hist301, ['15.04.2017', '22.05.2017', '02.06.2017']).
fechaexam(hist301, ['16.04.2017', '23.05.2017', '03.06.2017']).
fechaexam(hist301, ['17.04.2017', '24.05.2017', '04.06.2017']).
fechaexam(hist301, ['18.04.2017', '25.05.2017', '05.06.2017']).
fechaexam(hist301, ['19.04.2017', '26.05.2017', '06.06.2017']).
fechaexam(hist301, ['20.04.2017', '27.05.2017', '07.06.2017']).

% Inicio de programa
% Predicados para realizar ciertas operaciones

% Hacer un merge de una lista de listas a una sola lista
flatten([], []) :- !.
flatten([L|Ls], FlatL) :-
	!,
	flatten(L, NewL),
	flatten(Ls, NewLs),
	append(NewL, NewLs, FlatL).
flatten(L, [L]).

% Obtener las fechas de examenes de un curso
obtener_fechas(Id, Lista) :-
		bagof(ListaPred, fechaexam(Id, ListaPred), Matriz),
		flatten(Matriz, Lista).

% Nos retorna el ID de todos los estudiantes matriculados a un ID de un curso
estudiantes_matriculados(Id, IdResultado) :-
		estudiante(IdEstudiante, _, Cursos),
		member(Id, Cursos),
		IdResultado is IdEstudiante.

% Para cada curso, buscar las fechas y agregarlas a una lista
para_cada_curso([], []).
para_cada_curso([H | T], Lista) :-
		obtener_fechas(H, Fechas),
		para_cada_curso(T, FechasUnidas),
		append(Fechas, FechasUnidas, Lista).

% PROBLEMAS

% lista_estudiantes(id_curso, lista_e).
% Toma el id del curso y agrega a lista_e los estudiantes que toman el curso
% El mismo obtener_lista_estudiantes pero retorna todos los valores en una lista
lista_estudiantes(Id, Lista) :-
		bagof(ListaPred, estudiantes_matriculados(Id, ListaPred), Matriz),
		flatten(Matriz, Lista).

% lista_fechas(id_estudiante, lista_fechas).
% Toma el id del estudiante y agrega a lista_fechas las fechas de los examenes de los cursos que estÃ¡ tomando
lista_fechas(Id, Lista) :-
		estudiante(Id, _, Cursos),
		para_cada_curso(Cursos, Lista).

% aulas_adecuadas(id_curso, lista_aulas).
% Toma el id del curso y agrega a lista_aulas, el cÃ³digo del aula que tiene la cantidad suficiente de escritorios para izquierdos para ese curso
aulas_adecuadas(IdCurso, Lista) :-
		% Saber cuantos estudiantes zurdos hay en el curso
		% Para cada aula:
		% if escritorios para zurdos en el aula >= estudiantes then
		% Agregar el aula a la lista resultante
		IdCurso is 0.

